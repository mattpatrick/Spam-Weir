<!doctype html>
<html>
    <head>

        <script src='//code.jquery.com/jquery-1.7.2.min.js'></script>
	<script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.2.15.min.js"></script>
	<script src="/socket.io/socket.io.js"></script>
        <script>
            var socket = io.connect('127.0.0.1:8080');

            socket.on('welcome', function(data) {
                $('#messages').append('<li>' + data.message + '</li>');

                socket.emit('i am client', {data: 'foo!'});
            });
            socket.on('time', function(data) {
                console.log(data);
                $('#messages').append('<li>' + data.time + '</li>');
            });

            socket.on('success', function(data){
                $('#messages').append('<li>' + data.successMessage + '</li>');
            });
            

            socket.on('error', function() { console.error(arguments) });
            socket.on('message', function() { console.log(arguments) });
   
		function validatePhone(num) {
			var stripped = num.replace(/[\(\)\.\-\ ]/g, '');   
			document.getElementById('phone').value = stripped;  

			if (num == "") {
				error = "You didn't enter a phone number.\n";
				return false;
			} else if (isNaN(parseInt(stripped))) {
				error = "The phone number contains illegal characters.\n";
				return false;
			} else if (!(stripped.length == 10)) {
				error = "The phone number is the wrong length. Make sure you included an area code.\n";
				return false;
			} 
			return true;
		}
		
		function continueOrNot() {
			if(validatePhone(document.getElementById('phone').value)){
				alert('valid'); 
				return true;
			}else{ document.getElementById('phoneError').style.display = 'block'; return false;}
 		}

        </script>

	


    </head>
    <body>
        <u1 id = 'forms'>
            <form action="/wait" method="get" onsubmit="return continueOrNot()">
                Phone number: <input type="text" name="phone" id="phone">
		<input type="submit" value="Send">
            </form>
        </u1>    

	<div style="display:none" class="error" id="phoneError">
      		Please enter valid phone number
    	</div>

	<u3 id='messages'></u3>

    	<div style="display:none" class="success">
		Saved the phone number.
    	</div>

    </body>
</html>